<h2>Update request</h2>
<accordion close-others="oneAtATime"> <accordion-group
	heading="Update Request {{key}} at {{request.requestStart | date:'HH:mm:ss'}}"
	ng-repeat="(key,request) in node.updateRequests"> <ng-include
	src="'app/templates/request/request.html'"></ng-include> </accordion-group> </accordion>
	
<form name="updateForm" novalidate>

	<div class="form-group" ng-class="{ 'has-error has-feedback': updateForm.nid.$touched && updateForm.nid.$invalid || updateForm.nid.$invalid && updateForm.$submitted}" >
		<label for="update__nid">Nid</label>
		<input type="number" class="form-control" id="update__nid" name="nid" placeholder="Nid" ng-model="node.updateData.nid" required>
		<form-control-feedback></form-control-feedback>
		<div class="help-block">
			<p class="description" ng-if="!updateForm.nid.$touched && !updateForm.$submitted || updateForm.nid.$valid" >NID of the node to be loaded</p>
			<ng-messages class="error" ng-if="updateForm.nid.$invalid && updateForm.nid.$touched || updateForm.$submitted" for="updateForm.nid.$error">
				<ng-messages-include src="error-required"></ng-messages-include>
				<ng-messages-include src="error-number"></ng-messages-include>
			</ng-messages>
		</div>
	</div>

	<div class="form-group" ng-class="{ 'has-error has-feedback': updateForm.name.$touched && updateForm.name.$invalid || updateForm.name.$invalid && updateForm.$submitted}">
		<label for="update__name">Name</label>
		<input type="text" class="form-control" name="name" id="update__name" placeholder="Name" ng-model="node.updateData.name" ng-maxlength="60" required>
		<form-control-feedback></form-control-feedback>
		<div class="help-block">
			<p class="description" ng-if="!updateForm.name.$touched && !updateForm.$submitted || updateForm.name.$valid" >The node name</p>

			<ng-messages class="error" ng-if="updateForm.name.$invalid && updateForm.name.$touched || updateForm.$submitted" for="updateForm.name.$error">
				<ng-messages-include src="error-required"></ng-messages-include>
				
				<div ng-message="maxlength">
					Your nodename must be less than 61 characters long
				</div>
			</ng-messages>
		</div>
	</div>

	<div class="form-group" ng-class="{ 'has-error has-feedback': updateForm.email.$touched && updateForm.email.$invalid || updateForm.email.$invalid && updateForm.$submitted}">
		<label for="update__email">Email</label> 
		<input type="email" class="form-control" name="email" id="update__email" placeholder="Email" ng-model="node.updateData.mail" required>
		<form-control-feedback></form-control-feedback>
		<div class="help-block">
			<p class="description" ng-if="!updateForm.email.$touched && !updateForm.$submitted || updateForm.email.$valid" >The email address</p>

			<ng-messages class="error" ng-if="updateForm.email.$invalid && updateForm.email.$touched || updateForm.$submitted" for="updateForm.email.$error">
				<ng-messages-include src="error-required"></ng-messages-include>
				<ng-messages-include src="error-email"></ng-messages-include>
			</ng-messages>
		</div>
	</div>

	<div class="form-group">
		<label class="control-label" for="update__status">Status</label>
		<label class="radio-inline">
			<input type="radio" name="update__status" id="blocked" ng-model="node.updateData.status" value="0"> blocked
		</label>
		<label class="radio-inline">
			<input type="radio" name="update__status" id="active" ng-model="node.updateData.status" value="1" > active
		</label>
		<div class="help-block">
			<div>Value 0 for blocked, otherwise will be active by default</div>
		</div>
	</div>
	
	<div class="form-group">
		<label class="control-label" for="update__notify">Notify</label>
		<label class="radio-inline">
			<input type="radio" name="update__notify" id="notification" ng-model="node.updateData.notify" value="0"> no node notification
		</label>
		<label class="radio-inline">
			<input type="radio" name="update__notify" id="no_notification" ng-model="node.updateData.notify" value="1"> node notification
		</label>
		<div class="help-block">
			<div>Value 1 to notify node of new account, will not notify by default</div>
		</div>
	</div>
	
	<div class="form-group">
		<label ng-click="node.updateRolesColapsed = !node.updateRolesColapsed">Roles (optional) <span class="caret" ng-class="{true:'down',false:'up'}[node.updateRolesColapsed]"></span></label> 
	</div>
	<div class="well collapse" ng-class="!node.updateRolesColapsed && 'in'"> 
		<div class="form-group">

			<div class="checkbox disabled">
				<label>
					<input type="checkbox" name="update__role__anonymous_node" disabled>
					anonymous node (not available)
				</label>
			</div>

			<div class="checkbox disabled">
				<label>
					<input type="checkbox" name="update__role__authenticated_node" disabled>
					authenticated node (not available)
				</label>
			</div>

			<div class="checkbox">
				<label>
					<input type="checkbox" name="update__role__administrator" ng-model="node.updateData.roles.administrator" ng-true-value="'3'">
					administrator
				</label>
			</div>
			
			<div class="checkbox">
				<label>
					<input type="checkbox" name="update__role__editor" ng-model="node.updateData.roles.editor" ng-true-value="'4'">
					editor (custom updated role)
				</label>
			</div>

		</div>

	</div>
	
	<div class="form-group" ng-class="{ 'has-error has-feedback': updateForm.field_nickname.$touched && updateForm.field_nickname.$invalid || updateForm.field_nickname.$invalid && updateForm.$submitted}">
		<label for="update__field_nickname">Nickname</label> 
		<input type="field_nickname" class="form-control" name="field_nickname" id="update__field_nickname" placeholder="Nickname" ng-model="node.updateData.field_nickname" required>
		<form-control-feedback></form-control-feedback>
		<div class="help-block">
			<p  class="description" ng-if="!updateForm.field_nickname.$touched && !updateForm.$submitted || updateForm.field_nickname.$valid" >The node's nickname. ( Custom created field. Needs to be <a target="_blank" href="https://www.drupal.org/node/1354202" >formated properly</a>. )</p>

			<ng-messages class="error" ng-if="updateForm.field_nickname.$invalid && updateForm.field_nickname.$touched || updateForm.$submitted" for="updateForm.field_nickname.$error">
				<ng-messages-include src="error-required"></ng-messages-include>
			</ng-messages>
		</div>
	</div>

	<button class="btn btn-success" ng-click="node.doUpdate(updateForm)">update request</button>
</form>